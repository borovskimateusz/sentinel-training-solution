import "strings"

providers = {
	"azurerm": {
		"alias":               "",
		"config":              {},
		"module_address":      "",
		"name":                "azurerm",
		"provider_config_key": "azurerm",
		"version_constraint":  "=1.44.0",
	},
	"module.windowsserver:azurerm": {
		"alias":               "",
		"config":              {},
		"module_address":      "module.windowsserver",
		"name":                "azurerm",
		"provider_config_key": "module.windowsserver:azurerm",
		"version_constraint":  ">= 0.3",
	},
	"module.windowsserver:random": {
		"alias":               "",
		"config":              {},
		"module_address":      "module.windowsserver",
		"name":                "random",
		"provider_config_key": "module.windowsserver:random",
		"version_constraint":  ">= 1.0",
	},
}

resources = {
	"module.network.azurerm_network_security_group.security_group": {
		"address": "module.network.azurerm_network_security_group.security_group",
		"config": {
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"var.sg_name",
				],
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.network",
				],
			},
			"tags": {
				"references": [
					"var.tags",
				],
			},
		},
		"count":               {},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.network",
		"name":                "security_group",
		"provider_config_key": "module.network:azurerm",
		"provisioners":        [],
		"type":                "azurerm_network_security_group",
	},
	"module.network.azurerm_network_security_rule.security_rule_rdp": {
		"address": "module.network.azurerm_network_security_rule.security_rule_rdp",
		"config": {
			"access": {
				"constant_value": "Allow",
			},
			"destination_address_prefix": {
				"constant_value": "*",
			},
			"destination_port_range": {
				"constant_value": "3389",
			},
			"direction": {
				"constant_value": "Inbound",
			},
			"name": {
				"constant_value": "rdp",
			},
			"network_security_group_name": {
				"references": [
					"azurerm_network_security_group.security_group",
				],
			},
			"priority": {
				"constant_value": 101,
			},
			"protocol": {
				"constant_value": "Tcp",
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.network",
				],
			},
			"source_address_prefix": {
				"constant_value": "*",
			},
			"source_port_range": {
				"constant_value": "*",
			},
		},
		"count": {
			"references": [
				"var.allow_rdp_traffic",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.network",
		"name":                "security_rule_rdp",
		"provider_config_key": "module.network:azurerm",
		"provisioners":        [],
		"type":                "azurerm_network_security_rule",
	},
	"module.network.azurerm_network_security_rule.security_rule_ssh": {
		"address": "module.network.azurerm_network_security_rule.security_rule_ssh",
		"config": {
			"access": {
				"constant_value": "Allow",
			},
			"destination_address_prefix": {
				"constant_value": "*",
			},
			"destination_port_range": {
				"constant_value": "22",
			},
			"direction": {
				"constant_value": "Inbound",
			},
			"name": {
				"constant_value": "ssh",
			},
			"network_security_group_name": {
				"references": [
					"azurerm_network_security_group.security_group",
				],
			},
			"priority": {
				"constant_value": 102,
			},
			"protocol": {
				"constant_value": "Tcp",
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.network",
				],
			},
			"source_address_prefix": {
				"constant_value": "*",
			},
			"source_port_range": {
				"constant_value": "*",
			},
		},
		"count": {
			"references": [
				"var.allow_ssh_traffic",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.network",
		"name":                "security_rule_ssh",
		"provider_config_key": "module.network:azurerm",
		"provisioners":        [],
		"type":                "azurerm_network_security_rule",
	},
	"module.network.azurerm_resource_group.network": {
		"address": "module.network.azurerm_resource_group.network",
		"config": {
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"var.resource_group_name",
				],
			},
		},
		"count":               {},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.network",
		"name":                "network",
		"provider_config_key": "module.network:azurerm",
		"provisioners":        [],
		"type":                "azurerm_resource_group",
	},
	"module.network.azurerm_subnet.subnet": {
		"address": "module.network.azurerm_subnet.subnet",
		"config": {
			"address_prefix": {
				"references": [
					"var.subnet_prefixes",
					"count.index",
				],
			},
			"name": {
				"references": [
					"var.subnet_names",
					"count.index",
				],
			},
			"network_security_group_id": {
				"references": [
					"azurerm_network_security_group.security_group",
				],
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.network",
				],
			},
			"virtual_network_name": {
				"references": [
					"azurerm_virtual_network.vnet",
				],
			},
		},
		"count": {
			"references": [
				"var.subnet_names",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.network",
		"name":                "subnet",
		"provider_config_key": "module.network:azurerm",
		"provisioners":        [],
		"type":                "azurerm_subnet",
	},
	"module.network.azurerm_virtual_network.vnet": {
		"address": "module.network.azurerm_virtual_network.vnet",
		"config": {
			"address_space": {
				"references": [
					"var.address_space",
				],
			},
			"dns_servers": {
				"references": [
					"var.dns_servers",
				],
			},
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"var.vnet_name",
				],
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.network",
				],
			},
			"tags": {
				"references": [
					"var.tags",
				],
			},
		},
		"count":               {},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.network",
		"name":                "vnet",
		"provider_config_key": "module.network:azurerm",
		"provisioners":        [],
		"type":                "azurerm_virtual_network",
	},
	"module.windowsserver.azurerm_availability_set.vm": {
		"address": "module.windowsserver.azurerm_availability_set.vm",
		"config": {
			"location": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
			"managed": {
				"constant_value": true,
			},
			"name": {
				"references": [
					"var.vm_hostname",
				],
			},
			"platform_fault_domain_count": {
				"constant_value": 2,
			},
			"platform_update_domain_count": {
				"constant_value": 2,
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
		},
		"count":               {},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_availability_set",
	},
	"module.windowsserver.azurerm_network_interface.vm": {
		"address": "module.windowsserver.azurerm_network_interface.vm",
		"config": {
			"ip_configuration": {
				"constant_value": null,
			},
			"location": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
			"name": {
				"references": [
					"var.vm_hostname",
					"count.index",
				],
			},
			"network_security_group_id": {
				"references": [
					"azurerm_network_security_group.vm",
				],
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
		},
		"count": {
			"references": [
				"var.nb_instances",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_network_interface",
	},
	"module.windowsserver.azurerm_network_security_group.vm": {
		"address": "module.windowsserver.azurerm_network_security_group.vm",
		"config": {
			"location": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
			"name": {
				"references": [
					"var.vm_hostname",
					"var.remote_port",
					"module.os.calculated_remote_port",
				],
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
		},
		"count":               {},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_network_security_group",
	},
	"module.windowsserver.azurerm_public_ip.vm": {
		"address": "module.windowsserver.azurerm_public_ip.vm",
		"config": {
			"domain_name_label": {
				"references": [
					"var.public_ip_dns",
					"count.index",
				],
			},
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"var.vm_hostname",
					"count.index",
				],
			},
			"public_ip_address_allocation": {
				"references": [
					"var.public_ip_address_allocation",
				],
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
		},
		"count": {
			"references": [
				"var.nb_public_ip",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_public_ip",
	},
	"module.windowsserver.azurerm_resource_group.vm": {
		"address": "module.windowsserver.azurerm_resource_group.vm",
		"config": {
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"var.resource_group_name",
				],
			},
			"tags": {
				"references": [
					"var.tags",
				],
			},
		},
		"count":               {},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_resource_group",
	},
	"module.windowsserver.azurerm_storage_account.vm-sa": {
		"address": "module.windowsserver.azurerm_storage_account.vm-sa",
		"config": {
			"account_replication_type": {
				"references": [
					"var.boot_diagnostics_sa_type",
				],
			},
			"account_tier": {
				"references": [
					"var.boot_diagnostics_sa_type",
				],
			},
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"random_id.vm-sa",
				],
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
			"tags": {
				"references": [
					"var.tags",
				],
			},
		},
		"count": {
			"references": [
				"var.boot_diagnostics",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm-sa",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_storage_account",
	},
	"module.windowsserver.azurerm_virtual_machine.vm-linux": {
		"address": "module.windowsserver.azurerm_virtual_machine.vm-linux",
		"config": {
			"availability_set_id": {
				"references": [
					"azurerm_availability_set.vm",
				],
			},
			"boot_diagnostics": {
				"constant_value": null,
			},
			"delete_os_disk_on_termination": {
				"references": [
					"var.delete_os_disk_on_termination",
				],
			},
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"var.vm_hostname",
					"count.index",
				],
			},
			"network_interface_ids": {
				"references": [
					"azurerm_network_interface.vm",
					"count.index",
				],
			},
			"os_profile": {
				"constant_value": null,
			},
			"os_profile_linux_config": {
				"constant_value": null,
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
			"storage_image_reference": {
				"constant_value": null,
			},
			"storage_os_disk": {
				"constant_value": null,
			},
			"tags": {
				"references": [
					"var.tags",
				],
			},
			"vm_size": {
				"references": [
					"var.vm_size",
				],
			},
		},
		"count": {
			"references": [
				"var.vm_os_simple",
				"var.vm_os_offer",
				"var.is_windows_image",
				"var.data_disk",
				"var.nb_instances",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm-linux",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_virtual_machine",
	},
	"module.windowsserver.azurerm_virtual_machine.vm-linux-with-datadisk": {
		"address": "module.windowsserver.azurerm_virtual_machine.vm-linux-with-datadisk",
		"config": {
			"availability_set_id": {
				"references": [
					"azurerm_availability_set.vm",
				],
			},
			"boot_diagnostics": {
				"constant_value": null,
			},
			"delete_os_disk_on_termination": {
				"references": [
					"var.delete_os_disk_on_termination",
				],
			},
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"var.vm_hostname",
					"count.index",
				],
			},
			"network_interface_ids": {
				"references": [
					"azurerm_network_interface.vm",
					"count.index",
				],
			},
			"os_profile": {
				"constant_value": null,
			},
			"os_profile_linux_config": {
				"constant_value": null,
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
			"storage_data_disk": {
				"constant_value": null,
			},
			"storage_image_reference": {
				"constant_value": null,
			},
			"storage_os_disk": {
				"constant_value": null,
			},
			"tags": {
				"references": [
					"var.tags",
				],
			},
			"vm_size": {
				"references": [
					"var.vm_size",
				],
			},
		},
		"count": {
			"references": [
				"var.vm_os_simple",
				"var.vm_os_offer",
				"var.is_windows_image",
				"var.data_disk",
				"var.nb_instances",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm-linux-with-datadisk",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_virtual_machine",
	},
	"module.windowsserver.azurerm_virtual_machine.vm-windows": {
		"address": "module.windowsserver.azurerm_virtual_machine.vm-windows",
		"config": {
			"availability_set_id": {
				"references": [
					"azurerm_availability_set.vm",
				],
			},
			"boot_diagnostics": {
				"constant_value": null,
			},
			"delete_os_disk_on_termination": {
				"references": [
					"var.delete_os_disk_on_termination",
				],
			},
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"var.vm_hostname",
					"count.index",
				],
			},
			"network_interface_ids": {
				"references": [
					"azurerm_network_interface.vm",
					"count.index",
				],
			},
			"os_profile": {
				"constant_value": null,
			},
			"os_profile_windows_config": {
				"constant_value": null,
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
			"storage_image_reference": {
				"constant_value": null,
			},
			"storage_os_disk": {
				"constant_value": null,
			},
			"tags": {
				"references": [
					"var.tags",
				],
			},
			"vm_size": {
				"references": [
					"var.vm_size",
				],
			},
		},
		"count": {
			"references": [
				"var.vm_os_id",
				"var.is_windows_image",
				"var.vm_os_simple",
				"var.vm_os_offer",
				"var.data_disk",
				"var.nb_instances",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm-windows",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_virtual_machine",
	},
	"module.windowsserver.azurerm_virtual_machine.vm-windows-with-datadisk": {
		"address": "module.windowsserver.azurerm_virtual_machine.vm-windows-with-datadisk",
		"config": {
			"availability_set_id": {
				"references": [
					"azurerm_availability_set.vm",
				],
			},
			"boot_diagnostics": {
				"constant_value": null,
			},
			"delete_os_disk_on_termination": {
				"references": [
					"var.delete_os_disk_on_termination",
				],
			},
			"location": {
				"references": [
					"var.location",
				],
			},
			"name": {
				"references": [
					"var.vm_hostname",
					"count.index",
				],
			},
			"network_interface_ids": {
				"references": [
					"azurerm_network_interface.vm",
					"count.index",
				],
			},
			"os_profile": {
				"constant_value": null,
			},
			"os_profile_windows_config": {
				"constant_value": null,
			},
			"resource_group_name": {
				"references": [
					"azurerm_resource_group.vm",
				],
			},
			"storage_data_disk": {
				"constant_value": null,
			},
			"storage_image_reference": {
				"constant_value": null,
			},
			"storage_os_disk": {
				"constant_value": null,
			},
			"tags": {
				"references": [
					"var.tags",
				],
			},
			"vm_size": {
				"references": [
					"var.vm_size",
				],
			},
		},
		"count": {
			"references": [
				"var.vm_os_id",
				"var.is_windows_image",
				"var.vm_os_simple",
				"var.vm_os_offer",
				"var.data_disk",
				"var.nb_instances",
			],
		},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm-windows-with-datadisk",
		"provider_config_key": "module.windowsserver:azurerm",
		"provisioners":        [],
		"type":                "azurerm_virtual_machine",
	},
	"module.windowsserver.random_id.vm-sa": {
		"address": "module.windowsserver.random_id.vm-sa",
		"config": {
			"byte_length": {
				"constant_value": 6,
			},
			"keepers": {
				"references": [
					"var.vm_hostname",
				],
			},
		},
		"count":               {},
		"depends_on":          [],
		"for_each":            {},
		"mode":                "managed",
		"module_address":      "module.windowsserver",
		"name":                "vm-sa",
		"provider_config_key": "module.windowsserver:random",
		"provisioners":        [],
		"type":                "random_id",
	},
}

provisioners = {}

variables = {
	"admin_password": {
		"default":        "pTFE1234!",
		"description":    "admin password for Windows VM",
		"module_address": "",
		"name":           "admin_password",
	},
	"location": {
		"default":        "East US",
		"description":    "Azure location in which to create resources",
		"module_address": "",
		"name":           "location",
	},
	"module.network:address_space": {
		"default":        "10.0.0.0/16",
		"description":    "The address space that is used by the virtual network.",
		"module_address": "module.network",
		"name":           "address_space",
	},
	"module.network:allow_rdp_traffic": {
		"default":        false,
		"description":    "This optional variable, when set to true, adds a security rule allowing RDP traffic to flow through to the newly created network. The default value is false.",
		"module_address": "module.network",
		"name":           "allow_rdp_traffic",
	},
	"module.network:allow_ssh_traffic": {
		"default":        false,
		"description":    "This optional variable, when set to true, adds a security rule allowing SSH traffic to flow through to the newly created network. The default value is false.",
		"module_address": "module.network",
		"name":           "allow_ssh_traffic",
	},
	"module.network:dns_servers": {
		"default":        [],
		"description":    "The DNS servers to be used with vNet.",
		"module_address": "module.network",
		"name":           "dns_servers",
	},
	"module.network:location": {
		"default":        null,
		"description":    "The location/region where the core network will be created. The full list of Azure regions can be found at https://azure.microsoft.com/regions",
		"module_address": "module.network",
		"name":           "location",
	},
	"module.network:resource_group_name": {
		"default":        "myapp-rg",
		"description":    "Default resource group name that the network will be created in.",
		"module_address": "module.network",
		"name":           "resource_group_name",
	},
	"module.network:sg_name": {
		"default":        "acctsecgrp",
		"description":    "Give a name to security group",
		"module_address": "module.network",
		"name":           "sg_name",
	},
	"module.network:subnet_names": {
		"default": [
			"subnet1",
		],
		"description":    "A list of public subnets inside the vNet.",
		"module_address": "module.network",
		"name":           "subnet_names",
	},
	"module.network:subnet_prefixes": {
		"default": [
			"10.0.1.0/24",
		],
		"description":    "The address prefix to use for the subnet.",
		"module_address": "module.network",
		"name":           "subnet_prefixes",
	},
	"module.network:tags": {
		"default": {
			"tag1": "",
			"tag2": "",
		},
		"description":    "The tags to associate with your network and subnets.",
		"module_address": "module.network",
		"name":           "tags",
	},
	"module.network:vnet_name": {
		"default":        "acctvnet",
		"description":    "Name of the vnet to create",
		"module_address": "module.network",
		"name":           "vnet_name",
	},
	"module.windowsserver.module.os:standard_os": {
		"default": {
			"CentOS":        "OpenLogic,CentOS,7.3",
			"CoreOS":        "CoreOS,CoreOS,Stable",
			"Debian":        "credativ,Debian,8",
			"RHEL":          "RedHat,RHEL,7.3",
			"SLES":          "SUSE,SLES,12-SP2",
			"UbuntuServer":  "Canonical,UbuntuServer,16.04-LTS",
			"WindowsServer": "MicrosoftWindowsServer,WindowsServer,2016-Datacenter",
			"openSUSE-Leap": "SUSE,openSUSE-Leap,42.2",
		},
		"description":    "",
		"module_address": "module.windowsserver.module.os",
		"name":           "standard_os",
	},
	"module.windowsserver.module.os:vm_os_simple": {
		"default":        "",
		"description":    "",
		"module_address": "module.windowsserver.module.os",
		"name":           "vm_os_simple",
	},
	"module.windowsserver:admin_password": {
		"default":        "",
		"description":    "The admin password to be used on the VMSS that will be deployed. The password must meet the complexity requirements of Azure",
		"module_address": "module.windowsserver",
		"name":           "admin_password",
	},
	"module.windowsserver:admin_username": {
		"default":        "azureuser",
		"description":    "The admin username of the VM that will be deployed",
		"module_address": "module.windowsserver",
		"name":           "admin_username",
	},
	"module.windowsserver:boot_diagnostics": {
		"default":        "false",
		"description":    "(Optional) Enable or Disable boot diagnostics",
		"module_address": "module.windowsserver",
		"name":           "boot_diagnostics",
	},
	"module.windowsserver:boot_diagnostics_sa_type": {
		"default":        "Standard_LRS",
		"description":    "(Optional) Storage account type for boot diagnostics",
		"module_address": "module.windowsserver",
		"name":           "boot_diagnostics_sa_type",
	},
	"module.windowsserver:data_disk": {
		"default":        "false",
		"description":    "Set to true to add a datadisk.",
		"module_address": "module.windowsserver",
		"name":           "data_disk",
	},
	"module.windowsserver:data_disk_size_gb": {
		"default":        "",
		"description":    "Storage data disk size size",
		"module_address": "module.windowsserver",
		"name":           "data_disk_size_gb",
	},
	"module.windowsserver:data_sa_type": {
		"default":        "Standard_LRS",
		"description":    "Data Disk Storage Account type",
		"module_address": "module.windowsserver",
		"name":           "data_sa_type",
	},
	"module.windowsserver:delete_os_disk_on_termination": {
		"default":        "false",
		"description":    "Delete datadisk when machine is terminated",
		"module_address": "module.windowsserver",
		"name":           "delete_os_disk_on_termination",
	},
	"module.windowsserver:is_windows_image": {
		"default":        "false",
		"description":    "Boolean flag to notify when the custom image is windows based. Only used in conjunction with vm_os_id",
		"module_address": "module.windowsserver",
		"name":           "is_windows_image",
	},
	"module.windowsserver:location": {
		"default":        null,
		"description":    "The location/region where the virtual network is created. Changing this forces a new resource to be created.",
		"module_address": "module.windowsserver",
		"name":           "location",
	},
	"module.windowsserver:nb_instances": {
		"default":        "1",
		"description":    "Specify the number of vm instances",
		"module_address": "module.windowsserver",
		"name":           "nb_instances",
	},
	"module.windowsserver:nb_public_ip": {
		"default":        "1",
		"description":    "Number of public IPs to assign corresponding to one IP per vm. Set to 0 to not assign any public IP addresses.",
		"module_address": "module.windowsserver",
		"name":           "nb_public_ip",
	},
	"module.windowsserver:public_ip_address_allocation": {
		"default":        "dynamic",
		"description":    "Defines how an IP address is assigned. Options are Static or Dynamic.",
		"module_address": "module.windowsserver",
		"name":           "public_ip_address_allocation",
	},
	"module.windowsserver:public_ip_dns": {
		"default": [
			"",
		],
		"description":    "Optional globally unique per datacenter region domain name label to apply to each public ip address. e.g. thisvar.varlocation.cloudapp.azure.com where you specify only thisvar here. This is an array of names which will pair up sequentially to the number of public ips defined in var.nb_public_ip. One name or empty string is required for every public ip. If no public ip is desired, then set this to an array with a single empty string.",
		"module_address": "module.windowsserver",
		"name":           "public_ip_dns",
	},
	"module.windowsserver:remote_port": {
		"default":        "",
		"description":    "Remote tcp port to be used for access to the vms created via the nsg applied to the nics.",
		"module_address": "module.windowsserver",
		"name":           "remote_port",
	},
	"module.windowsserver:resource_group_name": {
		"default":        "terraform-compute",
		"description":    "The name of the resource group in which the resources will be created",
		"module_address": "module.windowsserver",
		"name":           "resource_group_name",
	},
	"module.windowsserver:ssh_key": {
		"default":        "~/.ssh/id_rsa.pub",
		"description":    "Path to the public key to be used for ssh access to the VM.  Only used with non-Windows vms and can be left as-is even if using Windows vms. If specifying a path to a certification on a Windows machine to provision a linux vm use the / in the path versus backslash. e.g. c:/home/id_rsa.pub",
		"module_address": "module.windowsserver",
		"name":           "ssh_key",
	},
	"module.windowsserver:storage_account_type": {
		"default":        "Premium_LRS",
		"description":    "Defines the type of storage account to be created. Valid options are Standard_LRS, Standard_ZRS, Standard_GRS, Standard_RAGRS, Premium_LRS.",
		"module_address": "module.windowsserver",
		"name":           "storage_account_type",
	},
	"module.windowsserver:tags": {
		"default": {
			"source": "terraform",
		},
		"description":    "A map of the tags to use on the resources that are deployed with this module.",
		"module_address": "module.windowsserver",
		"name":           "tags",
	},
	"module.windowsserver:vm_hostname": {
		"default":        "myvm",
		"description":    "local name of the VM",
		"module_address": "module.windowsserver",
		"name":           "vm_hostname",
	},
	"module.windowsserver:vm_os_id": {
		"default":        "",
		"description":    "The resource ID of the image that you want to deploy if you are using a custom image.Note, need to provide is_windows_image = true for windows custom images.",
		"module_address": "module.windowsserver",
		"name":           "vm_os_id",
	},
	"module.windowsserver:vm_os_offer": {
		"default":        "",
		"description":    "The name of the offer of the image that you want to deploy. This is ignored when vm_os_id or vm_os_simple are provided.",
		"module_address": "module.windowsserver",
		"name":           "vm_os_offer",
	},
	"module.windowsserver:vm_os_publisher": {
		"default":        "",
		"description":    "The name of the publisher of the image that you want to deploy. This is ignored when vm_os_id or vm_os_simple are provided.",
		"module_address": "module.windowsserver",
		"name":           "vm_os_publisher",
	},
	"module.windowsserver:vm_os_simple": {
		"default":        "",
		"description":    "Specify UbuntuServer, WindowsServer, RHEL, openSUSE-Leap, CentOS, Debian, CoreOS and SLES to get the latest image version of the specified os.  Do not provide this value if a custom value is used for vm_os_publisher, vm_os_offer, and vm_os_sku.",
		"module_address": "module.windowsserver",
		"name":           "vm_os_simple",
	},
	"module.windowsserver:vm_os_sku": {
		"default":        "",
		"description":    "The sku of the image that you want to deploy. This is ignored when vm_os_id or vm_os_simple are provided.",
		"module_address": "module.windowsserver",
		"name":           "vm_os_sku",
	},
	"module.windowsserver:vm_os_version": {
		"default":        "latest",
		"description":    "The version of the image that you want to deploy. This is ignored when vm_os_id or vm_os_simple are provided.",
		"module_address": "module.windowsserver",
		"name":           "vm_os_version",
	},
	"module.windowsserver:vm_size": {
		"default":        "Standard_DS1_V2",
		"description":    "Specifies the size of the virtual machine.",
		"module_address": "module.windowsserver",
		"name":           "vm_size",
	},
	"module.windowsserver:vnet_subnet_id": {
		"default":        null,
		"description":    "The subnet id of the virtual network where the virtual machines will reside.",
		"module_address": "module.windowsserver",
		"name":           "vnet_subnet_id",
	},
	"storage_account_type": {
		"default":        "Standard_LRS",
		"description":    "Defines the type of storage account: Standard_LRS, Standard_ZRS, Standard_GRS, Standard_RAGRS, Premium_LRS",
		"module_address": "",
		"name":           "storage_account_type",
	},
	"vm_size": {
		"default":        "Standard_A1",
		"description":    "size of the Azure VM",
		"module_address": "",
		"name":           "vm_size",
	},
	"windows_dns_prefix": {
		"default":        null,
		"description":    "DNS prefix to add to to public IP address for Windows VM",
		"module_address": "",
		"name":           "windows_dns_prefix",
	},
}

outputs = {
	"module.network:security_group_id": {
		"depends_on":     [],
		"description":    "The id of the security group attached to subnets inside the newly created vNet. Use this id to associate additional network security rules to subnets.",
		"module_address": "module.network",
		"name":           "security_group_id",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_network_security_group.security_group",
			],
		},
	},
	"module.network:vnet_address_space": {
		"depends_on":     [],
		"description":    "The address space of the newly created vNet",
		"module_address": "module.network",
		"name":           "vnet_address_space",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_virtual_network.vnet",
			],
		},
	},
	"module.network:vnet_id": {
		"depends_on":     [],
		"description":    "The id of the newly created vNet",
		"module_address": "module.network",
		"name":           "vnet_id",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_virtual_network.vnet",
			],
		},
	},
	"module.network:vnet_location": {
		"depends_on":     [],
		"description":    "The location of the newly created vNet",
		"module_address": "module.network",
		"name":           "vnet_location",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_virtual_network.vnet",
			],
		},
	},
	"module.network:vnet_name": {
		"depends_on":     [],
		"description":    "The Name of the newly created vNet",
		"module_address": "module.network",
		"name":           "vnet_name",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_virtual_network.vnet",
			],
		},
	},
	"module.network:vnet_subnets": {
		"depends_on":     [],
		"description":    "The ids of subnets created inside the newl vNet",
		"module_address": "module.network",
		"name":           "vnet_subnets",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_subnet.subnet",
			],
		},
	},
	"module.windowsserver.module.os:calculated_remote_port": {
		"depends_on":     [],
		"description":    "",
		"module_address": "module.windowsserver.module.os",
		"name":           "calculated_remote_port",
		"sensitive":      false,
		"value": {
			"references": [
				"var.standard_os",
				"var.vm_os_simple",
			],
		},
	},
	"module.windowsserver.module.os:calculated_value_os_offer": {
		"depends_on":     [],
		"description":    "",
		"module_address": "module.windowsserver.module.os",
		"name":           "calculated_value_os_offer",
		"sensitive":      false,
		"value": {
			"references": [
				"var.standard_os",
				"var.vm_os_simple",
			],
		},
	},
	"module.windowsserver.module.os:calculated_value_os_publisher": {
		"depends_on":     [],
		"description":    "",
		"module_address": "module.windowsserver.module.os",
		"name":           "calculated_value_os_publisher",
		"sensitive":      false,
		"value": {
			"references": [
				"var.standard_os",
				"var.vm_os_simple",
			],
		},
	},
	"module.windowsserver.module.os:calculated_value_os_sku": {
		"depends_on":     [],
		"description":    "",
		"module_address": "module.windowsserver.module.os",
		"name":           "calculated_value_os_sku",
		"sensitive":      false,
		"value": {
			"references": [
				"var.standard_os",
				"var.vm_os_simple",
			],
		},
	},
	"module.windowsserver:availability_set_id": {
		"depends_on":     [],
		"description":    "id of the availability set where the vms are provisioned.",
		"module_address": "module.windowsserver",
		"name":           "availability_set_id",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_availability_set.vm",
			],
		},
	},
	"module.windowsserver:network_interface_ids": {
		"depends_on":     [],
		"description":    "ids of the vm nics provisoned.",
		"module_address": "module.windowsserver",
		"name":           "network_interface_ids",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_network_interface.vm",
			],
		},
	},
	"module.windowsserver:network_interface_private_ip": {
		"depends_on":     [],
		"description":    "private ip addresses of the vm nics",
		"module_address": "module.windowsserver",
		"name":           "network_interface_private_ip",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_network_interface.vm",
			],
		},
	},
	"module.windowsserver:network_security_group_id": {
		"depends_on":     [],
		"description":    "id of the security group provisioned",
		"module_address": "module.windowsserver",
		"name":           "network_security_group_id",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_network_security_group.vm",
			],
		},
	},
	"module.windowsserver:public_ip_address": {
		"depends_on":     [],
		"description":    "The actual ip address allocated for the resource.",
		"module_address": "module.windowsserver",
		"name":           "public_ip_address",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_public_ip.vm",
			],
		},
	},
	"module.windowsserver:public_ip_dns_name": {
		"depends_on":     [],
		"description":    "fqdn to connect to the first vm provisioned.",
		"module_address": "module.windowsserver",
		"name":           "public_ip_dns_name",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_public_ip.vm",
			],
		},
	},
	"module.windowsserver:public_ip_id": {
		"depends_on":     [],
		"description":    "id of the public ip address provisoned.",
		"module_address": "module.windowsserver",
		"name":           "public_ip_id",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_public_ip.vm",
			],
		},
	},
	"module.windowsserver:vm_ids": {
		"depends_on":     [],
		"description":    "Virtual machine ids created.",
		"module_address": "module.windowsserver",
		"name":           "vm_ids",
		"sensitive":      false,
		"value": {
			"references": [
				"azurerm_virtual_machine.vm-windows",
				"azurerm_virtual_machine.vm-linux",
			],
		},
	},
	"windows_vm_public_name": {
		"depends_on":     [],
		"description":    "",
		"module_address": "",
		"name":           "windows_vm_public_name",
		"sensitive":      false,
		"value": {
			"references": [
				"module.windowsserver.public_ip_dns_name",
			],
		},
	},
}

module_calls = {
	"module.windowsserver:os": {
		"config": {
			"vm_os_simple": {
				"references": [
					"var.vm_os_simple",
				],
			},
		},
		"count":              {},
		"for_each":           {},
		"module_address":     "module.windowsserver",
		"name":               "os",
		"source":             "./os",
		"version_constraint": "",
	},
	"network": {
		"config": {
			"allow_ssh_traffic": {
				"constant_value": true,
			},
			"location": {
				"references": [
					"var.location",
				],
			},
			"resource_group_name": {
				"references": [
					"var.windows_dns_prefix",
				],
			},
		},
		"count":              {},
		"for_each":           {},
		"module_address":     "",
		"name":               "network",
		"source":             "Azure/network/azurerm",
		"version_constraint": "1.1.1",
	},
	"windowsserver": {
		"config": {
			"admin_password": {
				"references": [
					"var.admin_password",
				],
			},
			"location": {
				"references": [
					"var.location",
				],
			},
			"public_ip_dns": {
				"references": [
					"var.windows_dns_prefix",
				],
			},
			"resource_group_name": {
				"references": [
					"var.windows_dns_prefix",
				],
			},
			"storage_account_type": {
				"references": [
					"var.storage_account_type",
				],
			},
			"vm_hostname": {
				"constant_value": "demohost",
			},
			"vm_os_simple": {
				"constant_value": "WindowsServer",
			},
			"vm_size": {
				"references": [
					"var.vm_size",
				],
			},
			"vnet_subnet_id": {
				"references": [
					"module.network.vnet_subnets",
				],
			},
		},
		"count":              {},
		"for_each":           {},
		"module_address":     "",
		"name":               "windowsserver",
		"source":             "Azure/compute/azurerm",
		"version_constraint": "1.1.6",
	},
}

strip_index = func(addr) {
	s = strings.split(addr, ".")
	for s as i, v {
		s[i] = strings.split(v, "[")[0]
	}

	return strings.join(s, ".")
}
